from exercise_4.Exercise_4 import Protein


def test_get_data():
    property_dic = {'property':
        {
            'A': 1.8, 'R': -4.5, 'N': -3.5, 'D': -3.5, 'C': 2.5, 'E': -3.5, 'Q': -3.5, 'G': -0.4,
            'H': -3.2, 'I': 4.5, 'L': 3.8, 'K': -3.9, 'M': 1.9, 'F': 2.8, 'P': -1.6, 'S': -0.8,
            'T': -0.7, 'W': -0.9, 'Y': -1.3, 'V': 4.2}}
    ID = 'P32249'
    seq = 'MDIQMANNFTPPSATPQGNDCDLYAHHSTARIVMPLHYSLVFIIGLVGNLLALVVIVQNRKKINSTTLYSTNLVISDILFTTALPTRIAYYAMGFDWRIGDALCRITALVFYINTYAGVNFMTCLSIDRFIAVVHPLRYNKIKRIEHAKGVCIFVWILVFAQTLPLLINPMSKQEAERITCMEYPNFEETKSLPWILLGACFIGYVLPLIIILICYSQICCKLFRTAKQNPLTEKSGVNKKALNTIILIIVVFVLCFTPYHVAIIQHMIKKLRFSNFLECSQRHSFQISLHFTVCLMNFNCCMDPFIYFFACKGYKRKVMRMLKRQVSVSISSAVKSAPEENSREMTETQMMIHSKSSNGK'
    protein_instance = Protein(property_dic)
    assert protein_instance.get_data(ID) == seq


def test_map_property():
    property_dic = {'property':
        {
            'A': 1.8, 'R': -4.5, 'N': -3.5, 'D': -3.5, 'C': 2.5, 'E': -3.5, 'Q': -3.5, 'G': -0.4,
            'H': -3.2, 'I': 4.5, 'L': 3.8, 'K': -3.9, 'M': 1.9, 'F': 2.8, 'P': -1.6, 'S': -0.8,
            'T': -0.7, 'W': -0.9, 'Y': -1.3, 'V': 4.2}}
    ID = 'P32249'
    property_values = [1.9, -3.5, 4.5, -3.5, 1.9, 1.8, -3.5, -3.5, 2.8, -0.7, -1.6, -1.6, -0.8, 1.8, -0.7, -1.6, -3.5,
                       -0.4, -3.5, -3.5, 2.5, -3.5, 3.8, -1.3, 1.8, -3.2, -3.2, -0.8, -0.7, 1.8, -4.5, 4.5, 4.2, 1.9,
                       -1.6, 3.8, -3.2, -1.3, -0.8, 3.8, 4.2, 2.8, 4.5, 4.5, -0.4, 3.8, 4.2, -0.4, -3.5, 3.8, 3.8, 1.8,
                       3.8, 4.2, 4.2, 4.5, 4.2, -3.5, -3.5, -4.5, -3.9, -3.9, 4.5, -3.5, -0.8, -0.7, -0.7, 3.8, -1.3,
                       -0.8, -0.7, -3.5, 3.8, 4.2, 4.5, -0.8, -3.5, 4.5, 3.8, 2.8, -0.7, -0.7, 1.8, 3.8, -1.6, -0.7,
                       -4.5, 4.5, 1.8, -1.3, -1.3, 1.8, 1.9, -0.4, 2.8, -3.5, -0.9, -4.5, 4.5, -0.4, -3.5, 1.8, 3.8,
                       2.5, -4.5, 4.5, -0.7, 1.8, 3.8, 4.2, 2.8, -1.3, 4.5, -3.5, -0.7, -1.3, 1.8, -0.4, 4.2, -3.5, 2.8,
                       1.9, -0.7, 2.5, 3.8, -0.8, 4.5, -3.5, -4.5, 2.8, 4.5, 1.8, 4.2, 4.2, -3.2, -1.6, 3.8, -4.5, -1.3,
                       -3.5, -3.9, 4.5, -3.9, -4.5, 4.5, -3.5, -3.2, 1.8, -3.9, -0.4, 4.2, 2.5, 4.5, 2.8, 4.2, -0.9,
                       4.5, 3.8, 4.2, 2.8, 1.8, -3.5, -0.7, 3.8, -1.6, 3.8, 3.8, 4.5, -3.5, -1.6, 1.9, -0.8, -3.9, -3.5,
                       -3.5, 1.8, -3.5, -4.5, 4.5, -0.7, 2.5, 1.9, -3.5, -1.3, -1.6, -3.5, 2.8, -3.5, -3.5, -0.7, -3.9,
                       -0.8, 3.8, -1.6, -0.9, 4.5, 3.8, 3.8, -0.4, 1.8, 2.5, 2.8, 4.5, -0.4, -1.3, 4.2, 3.8, -1.6, 3.8,
                       4.5, 4.5, 4.5, 3.8, 4.5, 2.5, -1.3, -0.8, -3.5, 4.5, 2.5, 2.5, -3.9, 3.8, 2.8, -4.5, -0.7, 1.8,
                       -3.9, -3.5, -3.5, -1.6, 3.8, -0.7, -3.5, -3.9, -0.8, -0.4, 4.2, -3.5, -3.9, -3.9, 1.8, 3.8, -3.5,
                       -0.7, 4.5, 4.5, 3.8, 4.5, 4.5, 4.2, 4.2, 2.8, 4.2, 3.8, 2.5, 2.8, -0.7, -1.6, -1.3, -3.2, 4.2,
                       1.8, 4.5, 4.5, -3.5, -3.2, 1.9, 4.5, -3.9, -3.9, 3.8, -4.5, 2.8, -0.8, -3.5, 2.8, 3.8, -3.5, 2.5,
                       -0.8, -3.5, -4.5, -3.2, -0.8, 2.8, -3.5, 4.5, -0.8, 3.8, -3.2, 2.8, -0.7, 4.2, 2.5, 3.8, 1.9,
                       -3.5, 2.8, -3.5, 2.5, 2.5, 1.9, -3.5, -1.6, 2.8, 4.5, -1.3, 2.8, 2.8, 1.8, 2.5, -3.9, -0.4, -1.3,
                       -3.9, -4.5, -3.9, 4.2, 1.9, -4.5, 1.9, 3.8, -3.9, -4.5, -3.5, 4.2, -0.8, 4.2, -0.8, 4.5, -0.8,
                       -0.8, 1.8, 4.2, -3.9, -0.8, 1.8, -1.6, -3.5, -3.5, -3.5, -0.8, -4.5, -3.5, 1.9, -0.7, -3.5, -0.7,
                       -3.5, 1.9, 1.9, 4.5, -3.2, -0.8, -3.9, -0.8, -0.8, -3.5, -0.4, -3.9]
    protein_instance = Protein(property_dic)
    protein_instance.get_data(ID)
    assert protein_instance.map_property('property') == property_values


def test_rolling_mean():
    property_dic = {'property':
        {
            'A': 1.8, 'R': -4.5, 'N': -3.5, 'D': -3.5, 'C': 2.5, 'E': -3.5, 'Q': -3.5, 'G': -0.4,
            'H': -3.2, 'I': 4.5, 'L': 3.8, 'K': -3.9, 'M': 1.9, 'F': 2.8, 'P': -1.6, 'S': -0.8,
            'T': -0.7, 'W': -0.9, 'Y': -1.3, 'V': 4.2}}
    ID = 'P32249'
    property_values = [-0.31333333333333335, -0.5466666666666667, -0.5466666666666667, -0.8733333333333334,
                       -0.8733333333333334, -1.2333333333333334, -1.1866666666666668, -1.1866666666666668, -0.7,
                       -0.9733333333333334, -0.8066666666666665, -0.9133333333333333, -1.0199999999999998, -1.02,
                       -1.1866666666666665, -1.0199999999999998, -1.2133333333333336, -0.6799999999999999,
                       -0.37333333333333335, -0.013333333333333374, 0.11333333333333329, 0.19999999999999993,
                       0.21999999999999986, -0.12000000000000012, -0.08666666666666674, 0.04666666666666656,
                       0.5399999999999999, 0.9400000000000001, 1.2933333333333334, 1.6400000000000001,
                       1.4933333333333334, 2.046666666666667, 2.026666666666667, 1.72, 1.36, 1.7200000000000002, 1.72,
                       2.0533333333333337, 2.393333333333333, 2.726666666666667, 2.7533333333333334, 2.773333333333334,
                       2.866666666666667, 2.3333333333333335, 1.8, 1.5266666666666666, 1.0133333333333332,
                       0.4733333333333332, 0.7999999999999997, 0.7999999999999997, 0.49333333333333307,
                       0.19333333333333325, 0.026666666666666526, 0.026666666666666748, -0.3400000000000001,
                       -0.6733333333333335, -1.02, -1.5333333333333334, -1.0466666666666666, -0.5333333333333333,
                       0.06666666666666679, 0.2733333333333333, 0.3, 0.30000000000000004, 0.7866666666666667,
                       1.0266666666666668, 1.0266666666666668, 1.0266666666666668, 0.8933333333333334,
                       1.2333333333333336, 1.1800000000000002, 1.1800000000000002, 1.1133333333333335,
                       1.1600000000000001, 1.0000000000000004, 0.6133333333333334, 0.58, 0.9333333333333337, 0.76,
                       0.4799999999999999, 0.48000000000000004, 0.2933333333333333, 0.27999999999999986, -0.14,
                       -0.09333333333333335, -0.013333333333333383, -0.2, 0.22, 0.1733333333333333, 0.21999999999999992,
                       0.006666666666666643, 0.3933333333333333, 0.22666666666666657, 0.21999999999999995, 0.5,
                       0.5933333333333333, 1.0133333333333332, 0.9866666666666667, 1.5866666666666664,
                       1.0533333333333335, 1.0333333333333334, 1.18, 1.18, 0.9000000000000001, 1.0133333333333334,
                       1.0799999999999998, 0.9666666666666669, 1.1400000000000001, 0.9733333333333335,
                       0.8866666666666666, 0.8599999999999999, 0.6199999999999999, 1.0066666666666666,
                       0.47333333333333333, 0.4066666666666665, 0.6399999999999999, 1.0266666666666666,
                       1.0266666666666666, 1.3333333333333333, 1.3333333333333333, 1.353333333333333, 1.06,
                       1.1866666666666668, 0.9333333333333333, 0.6799999999999999, 0.1933333333333333,
                       -0.013333333333333315, -0.013333333333333286, -0.03999999999999997, -0.04000000000000006,
                       0.07333333333333333, -0.46, -0.7933333333333332, -0.9533333333333334, -1.4933333333333332,
                       -1.3066666666666664, -0.9199999999999998, -1.0066666666666666, -0.4066666666666665,
                       -0.1333333333333334, 0.37999999999999995, 0.5800000000000001, 0.5799999999999998,
                       1.0933333333333333, 1.6733333333333333, 1.5599999999999998, 1.9133333333333336,
                       1.8933333333333333, 1.7266666666666668, 2.24, 2.1599999999999997, 2.1333333333333333,
                       2.2199999999999998, 2.2199999999999998, 1.8000000000000003, 1.4133333333333336, 1.6,
                       1.2466666666666666, 0.7333333333333335, 0.21999999999999992, -0.20000000000000004,
                       -0.19999999999999993, -0.20000000000000018, -0.4533333333333333, -0.4066666666666665,
                       -0.3466666666666667, -0.43333333333333335, -0.56, -1.0933333333333333, -0.9466666666666668,
                       -0.9466666666666667, -1.3066666666666664, -1.0666666666666667, -1.0399999999999998, -1.04,
                       -0.8533333333333334, -1.2333333333333334, -1.0533333333333335, -0.5000000000000001,
                       -0.9066666666666666, -0.92, -0.7866666666666665, -0.6599999999999999, -0.1733333333333333,
                       -0.1133333333333335, 0.11333333333333326, 0.5133333333333332, 0.5133333333333332,
                       1.0466666666666666, 1.2533333333333334, 1.2133333333333334, 1.7533333333333334, 2.06, 1.7, 2.06,
                       2.42, 2.42, 2.466666666666667, 2.466666666666667, 2.7933333333333326, 2.8400000000000003,
                       2.586666666666667, 2.3466666666666667, 1.813333333333333, 2.14, 2.3933333333333335,
                       2.2800000000000002, 1.7666666666666666, 2.126666666666667, 2.06, 1.4600000000000002,
                       1.1133333333333333, 0.9333333333333333, 0.42000000000000015, -0.11333333333333326,
                       -0.5133333333333333, -0.5333333333333333, -0.22666666666666674, -0.04000000000000011,
                       -0.5733333333333334, -1.0000000000000002, -1.2199999999999998, -0.9866666666666668,
                       -0.9599999999999999, -1.38, -1.3399999999999999, -1.5533333333333332, -1.553333333333333,
                       -1.0399999999999998, -1.04, -0.8533333333333334, -0.4466666666666666, -0.4, -0.10000000000000006,
                       0.4333333333333333, 0.9933333333333333, 1.3266666666666667, 1.6333333333333333, 1.54,
                       2.0533333333333332, 2.566666666666667, 2.993333333333333, 3.0599999999999996, 2.7599999999999993,
                       2.886666666666666, 2.8466666666666662, 2.333333333333333, 2.313333333333333, 2.1799999999999997,
                       2.18, 2.18, 1.6666666666666667, 1.1733333333333333, 1.1133333333333333, 1.1333333333333333,
                       0.6199999999999999, 0.19333333333333327, 0.2599999999999999, 0.006666666666666525,
                       0.29999999999999993, 0.3333333333333333, 0.3133333333333333, 0.22, 0.3533333333333333,
                       -0.18000000000000008, -0.3133333333333334, -0.13333333333333333, -0.15333333333333332, -0.58,
                       -1.0933333333333333, -0.8866666666666667, -0.44000000000000017, -0.9266666666666665,
                       -0.3266666666666668, -0.5666666666666667, -0.2600000000000001, -0.24000000000000005,
                       -0.23999999999999996, -0.5400000000000001, -0.02666666666666669, -0.026666666666666748,
                       0.27999999999999997, 0.64, 0.7066666666666667, 1.1066666666666665, 0.9266666666666665,
                       0.9066666666666665, 1.3066666666666664, 1.133333333333333, 0.9533333333333331,
                       0.5933333333333333, 0.9933333333333333, 1.1066666666666667, 1.0666666666666667,
                       0.9733333333333334, 0.9933333333333333, 0.8599999999999999, 0.9, 0.8733333333333333,
                       0.6599999999999999, 0.8066666666666665, 0.37999999999999984, -0.08666666666666674,
                       -0.47333333333333333, 0.039999999999999945, 0.2733333333333334, -0.21333333333333326,
                       -0.3866666666666667, -0.046666666666666794, -0.49333333333333335, -0.9799999999999999,
                       -1.3333333333333333, -1.22, -1.0133333333333334, -0.7066666666666666, -0.6733333333333335,
                       -0.11333333333333341, 0.1333333333333334, 0.33999999999999997, 0.18000000000000002,
                       0.3333333333333334, 0.3733333333333333, 0.1933333333333334, 0.06000000000000005,
                       0.21333333333333337, 0.2800000000000002, 0.27999999999999997, -0.23333333333333334,
                       -0.23333333333333328, -0.8133333333333332, -0.9933333333333333, -1.1666666666666667,
                       -1.1600000000000001, -1.34, -1.5066666666666668, -2.02, -1.6333333333333333, -1.4533333333333336,
                       -1.2733333333333334, -1.3800000000000001, -1.2000000000000002, -1.2266666666666666,
                       -1.0466666666666666, -1.0466666666666666, -0.9800000000000001, -0.7733333333333333,
                       -1.1600000000000001]
    protein_instance = Protein(property_dic)
    protein_instance.get_data(ID)
    assert protein_instance.rolling_mean('property', 15) == property_values
